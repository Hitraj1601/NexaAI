import React from 'react';\nimport { AlertTriangle, RefreshCw } from 'lucide-react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  error: Error | null;\n  errorInfo: React.ErrorInfo | null;\n}\n\nclass ErrorBoundary extends React.Component<\n  React.PropsWithChildren<{\n    fallback?: React.ComponentType<{ error: Error; retry: () => void }>;\n    onError?: (error: Error, errorInfo: React.ErrorInfo) => void;\n  }>,\n  ErrorBoundaryState\n> {\n  constructor(\n    props: React.PropsWithChildren<{\n      fallback?: React.ComponentType<{ error: Error; retry: () => void }>;\n      onError?: (error: Error, errorInfo: React.ErrorInfo) => void;\n    }>\n  ) {\n    super(props);\n    this.state = { hasError: false, error: null, errorInfo: null };\n  }\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return {\n      hasError: true,\n      error,\n      errorInfo: null,\n    };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    this.setState({\n      error,\n      errorInfo,\n    });\n\n    // Log to external service\n    console.error('ErrorBoundary caught an error:', error, errorInfo);\n    \n    // Call onError callback if provided\n    this.props.onError?.(error, errorInfo);\n    \n    // Send to analytics/monitoring service\n    if (import.meta.env.PROD) {\n      // Send error to monitoring service like Sentry\n      // sentry.captureException(error, { extra: errorInfo });\n    }\n  }\n\n  retry = () => {\n    this.setState({ hasError: false, error: null, errorInfo: null });\n  };\n\n  render() {\n    if (this.state.hasError && this.state.error) {\n      if (this.props.fallback) {\n        const FallbackComponent = this.props.fallback;\n        return <FallbackComponent error={this.state.error} retry={this.retry} />;\n      }\n\n      return <DefaultErrorFallback error={this.state.error} retry={this.retry} />;\n    }\n\n    return this.props.children;\n  }\n}\n\n// Default error fallback component\nconst DefaultErrorFallback: React.FC<{ error: Error; retry: () => void }> = ({\n  error,\n  retry,\n}) => {\n  const isDev = import.meta.env.DEV;\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center p-4\">\n      <Card className=\"max-w-md w-full\">\n        <CardHeader>\n          <div className=\"flex items-center space-x-2\">\n            <AlertTriangle className=\"h-5 w-5 text-destructive\" />\n            <CardTitle>Something went wrong</CardTitle>\n          </div>\n          <CardDescription>\n            An unexpected error occurred while loading this page.\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {isDev && (\n            <details className=\"rounded bg-muted p-3 text-sm\">\n              <summary className=\"cursor-pointer font-medium mb-2\">\n                Error Details (Development)\n              </summary>\n              <pre className=\"whitespace-pre-wrap text-xs\">\n                {error.message}\n                {error.stack && `\\n\\n${error.stack}`}\n              </pre>\n            </details>\n          )}\n          \n          <div className=\"flex space-x-2\">\n            <Button onClick={retry} className=\"flex-1\">\n              <RefreshCw className=\"w-4 h-4 mr-2\" />\n              Try Again\n            </Button>\n            <Button\n              variant=\"outline\"\n              onClick={() => window.location.reload()}\n              className=\"flex-1\"\n            >\n              Reload Page\n            </Button>\n          </div>\n          \n          <p className=\"text-xs text-muted-foreground text-center\">\n            If the problem persists, please contact support.\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\n// Specialized error boundaries for different parts of the app\nexport const APIErrorBoundary: React.FC<React.PropsWithChildren> = ({ children }) => {\n  return (\n    <ErrorBoundary\n      fallback={({ error, retry }) => (\n        <Card className=\"m-4\">\n          <CardContent className=\"p-6 text-center\">\n            <AlertTriangle className=\"h-8 w-8 text-destructive mx-auto mb-4\" />\n            <h3 className=\"font-semibold mb-2\">Failed to load data</h3>\n            <p className=\"text-muted-foreground mb-4\">\n              There was a problem fetching the data. Please try again.\n            </p>\n            <Button onClick={retry}>\n              <RefreshCw className=\"w-4 h-4 mr-2\" />\n              Retry\n            </Button>\n          </CardContent>\n        </Card>\n      )}\n      onError={(error, errorInfo) => {\n        console.error('API Error:', error, errorInfo);\n      }}\n    >\n      {children}\n    </ErrorBoundary>\n  );\n};\n\nexport const ComponentErrorBoundary: React.FC<React.PropsWithChildren<{ name?: string }>> = ({ children, name }) => {\n  return (\n    <ErrorBoundary\n      fallback={({ retry }) => (\n        <div className=\"p-4 border border-destructive/20 rounded-lg bg-destructive/5\">\n          <div className=\"flex items-center space-x-2 mb-2\">\n            <AlertTriangle className=\"h-4 w-4 text-destructive\" />\n            <span className=\"text-sm font-medium\">Component Error</span>\n          </div>\n          <p className=\"text-sm text-muted-foreground mb-3\">\n            The {name || 'component'} failed to render properly.\n          </p>\n          <Button size=\"sm\" variant=\"outline\" onClick={retry}>\n            <RefreshCw className=\"w-3 h-3 mr-1\" />\n            Retry\n          </Button>\n        </div>\n      )}\n      onError={(error, errorInfo) => {\n        console.error(`Component Error in ${name}:`, error, errorInfo);\n      }}\n    >\n      {children}\n    </ErrorBoundary>\n  );\n};\n\nexport default ErrorBoundary;